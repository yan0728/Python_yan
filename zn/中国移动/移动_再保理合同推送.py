
import hashlib
import requests
import json
import time

# 推资产
var_method1 = 'extend.yidong.asset.create'
# 推合同
var_method2 = 'extend.yidong.contract.create'

time = time.strftime("%Y%m%d%H%M%S", time.localtime())
flowNo = 'NO' + time

var_channel = 'test11'
var_content = '9A77769D38977D06A0D8E4EDBDE3D04291AB9D06BCAEE0E08D0B10C63ACA57882347B2DD2156D760FB0EBA2A997DCC5211FDE610227AA41F6CB8FE39FD563934D1D87E11F0B9D2BDCA650EFA5E52F3F02B992E7B45182D8FFDC5C70B11BE7C77FC2703719404E59D2BD1E653B03FA972A6BF676F9202A5BAB7FB76BE80A658C35FB5C7F972E23FC7E42213C9595CF42B7E8344627DEE0D8E48FFB7BC8AA0620E705F6C9072D7C516DA7C5B5FFF5F8829E9951A778D81425565F4F6391121076C275E5F86501B1E2B2FA02DE659F99B925095A2F1C5896FAD66286A9A44D5D6C96493AB41B7DB6D8F6611B781A165B12CBA7C9F7B9241654CCC5C6CF0D770C91CB70C555812C15CB5F42C38197D9B82E3CD8320650DE945A2A27866BFB15414F4B8A77AFC7803EED1EDA279C3CBA862F386E5723DAB4E321CE804C3E63DAE5A855475184D7E6F28F77A6201D29385DB345F5593D5D7B6EEA0C6F5625BE8FA1418D1EF86D4FB5C4FAB0A4E6D702DCD01170A20C93203E8149D9C4F2D1C86E0E3FB789555F7444C52936B33A5033D32198F0EF0CADE0FF4229A6482AF991AF02568631232CD9D249830B882CA992A9BD1D56A65453DB7A072110D5242914D14A411321C2BBE98D37B800CD6D9FC6B38622D1A42ABE30AC4AE852E5553BAD7BBA12A2A573CC08D1889F7AC2CEEA8F8D9D75EE365D247C4C9E02599607CE714AC47E791C749616C2046F5D0888AA63698EDA9D631339CCDFBC4B6F683A733B41361FD4CE0BCDE61335E24C34EEA6C7C421CE1BFC575041E44A7BAD14801FCF9BA25BB8BDF989871ED17BFCBF048EAC7C048428EA78D44F60B76B13243C6BB85B8BB35468175D6983EAB89803DA31536C7B4832BE658AF96456C0F16A4EE340833D40886D86BD638AB1A64E109E6AD5B3794FC0F8BC9A2393591B0F239392BED355A5A5D2F8D1C68E0243CF2009BAE8252CF5552056651DFD3520BB61205BAD999B8930647B435DA40059900052C58AB5691F173828A57592D754B06B01305B43492142AC4B60B2D4A0988C8D46AB91719E0DBADD04F461B69427F39491231A2E167C5B5DE34F6A656F0155BBF5AA3570B3B93AACCEAE4A436207C601135D64D24B911D541C9F7FADD65BB1249F3FC81C10936047625E629033FC55D3A567E10A7D8E06A51BAEA82A72A16B8CE013E52CB8324EA0D6D1DA78C27DB10E4EE9012F8BD29396895EEA9D584AA83055977B7DDA3F3FEF5600DB175659BBD77210D937CFE4774F6C209FE8F6689EEA5D878CC8C6F3380B9E6FDF20B757371F615C0FFF3EAC7B00DE812D4D62848539A09D609004C7B08345E49386ADDE8EB4C8E3B09A69FC35FA7A6AE30C40FC575E946298B395989B4CCEBF8D4EC22C263C3A0929F729550980D006DD725AD728C36A07A6251A9BF033B84F1CFBD7458DB2D2B32AD087D438E39CAA1E76BD18EAB57E69E6DCF0827806A8B026C9D9878CBE57B926B3B1B7A867E1CA1CDC1D399DDC45044C93A2E45FAE0BD332B387F02859E9C117E19E1E5B3A79CA8ABAE74F0FB07644433D3CB72B3780BF78D2EEA09A5FADC0046490D98074DC4838281525155C2011BE36ACB1BED5F9C40CC995120A6B0D2068EA15535C35B654865C5B79C5E44B8A01AE014A292743EC355AB23F3AB83322F00826E319C536C3D292A8F0D029AF4BF87A9157A6058755A414B70A6B88CA21308D159013CC1C4A5CABC314B0E30E900D4E5DA1EC6915017D8D3E7E04A21C6C603CCA7D7D9011FB44E74894AD37F68A47088353DED63650882C2FC35B7BE4177CB4D266FCB883B972D7745BB11DF216C3714835B7E825CBD83AFCE23D530EB52AC968D78C35E3A395015C677196FDBF67893DBE32C4671473A0EB29BF1204544F3965660537B7DC9CA8A7EC2227376519080D1E405235BE90C98516D4FC812201CC535132718415BD6EC0EC0D6201FA6B3DE55461F417499B2E428AAAD6E7655A8E8D56F37257EE6D27B8E3B447982FBD12762027C097E591151E85D81A8414A9390A00778CD7F68DABBE5BB364AC21F46DF9279A964581D78CD9CE6DAF3BBA4A849C0616397E1BB9BC0A5CB41A7CB4B8EAE52700FE4A29F2A5AF010694A9E0043C3AD177A69EEAC3FE7831BB4D8A6DCD85B40441E49FC411F25068976333984042009DC0B20C7C55D6025F369B55B644154D66BC45E06458BDCC7C9DA829CDC23629BED'
var_flowNo = flowNo
var_method = var_method1
var_time = time
var_version = '1.0.1'

def pinChuan():
      chuan = ('IUY9JiCa35ktBHKrJaS3s+Q49GRXtbaW'
            'channel{}channel'
            'content{}content'
            'flowNo{}flowNo'
            'method{}method'
            'time{}time'
            'version{}version'
            'IUY9JiCa35ktBHKrJaS3s+Q49GRXtbaW'.format(var_channel,var_content,var_flowNo,var_method,var_time,var_version))
      print(chuan)
      return chuan


def AddMD5():
      str = pinChuan()
      # print("str:" + str)

      # 创建md5对象
      m = hashlib.md5()

      # Tips
      # 此处必须encode
      # 若写法为m.update(str)  报错为： Unicode-objects must be encoded before hashing
      # 因为python3里默认的str是unicode
      # 或者 b = bytes(str, encoding='utf-8')，作用相同，都是encode为bytes
      b = str.encode(encoding='utf-8')
      m.update(b)
      str_md5 = m.hexdigest()

      # print('MD5加密前为 ：' + str)
      # print('MD5加密后为小写 ：' + str_md5)

      # 另一种写法：b‘’前缀代表的就是bytes
      # str_md5 = hashlib.md5(b str).hexdigest()
      print('MD5加密后为大写 ：' + str_md5.upper())
      return str_md5.upper()

def requestData():
      header = {'Content-Type':'application/json;charset=UTF-8',
                'User-Agent': 'Apache-HttpClient/4.5.5 (Java/1.8.0_121)','Connection':'keep-alive'}
      url = 'https://test-api-yidong.lianjieabs.com/external/resources'

      data = {
          "flowNo": var_flowNo,
          "content": var_content,
          "time": var_time,
          "method": var_method,
          "channel": var_channel,
          "version": var_version,
          "sign": AddMD5()
      }

      r = requests.post(url=url,data=json.dumps(data) ,headers=header)
      # 打印的返回值是json格式
      print(json.dumps(r.json(),sort_keys=True, indent=2,ensure_ascii = False))

requestData()